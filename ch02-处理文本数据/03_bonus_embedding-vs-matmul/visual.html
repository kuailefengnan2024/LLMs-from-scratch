<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åµŒå…¥å±‚ä¸çº¿æ€§å±‚è¯¦ç»†åŸç†å¯¹æ¯”</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .mermaid {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            min-height: 600px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” åµŒå…¥å±‚ä¸çº¿æ€§å±‚è¯¦ç»†åŸç†å¯¹æ¯”</h1>
        
        <div class="mermaid">
            graph TD
                A["ğŸ¯ è¾“å…¥Token IDs<br/>[2, 3, 1]<br/>æ‰¹æ¬¡å¤§å°: 3"] --> B{ğŸš€ é€‰æ‹©å®ç°æ–¹å¼}
                
                %% åµŒå…¥å±‚è·¯å¾„
                B -->|é«˜æ•ˆç›´æ¥æŸ¥æ‰¾| C["ğŸ”§ nn.Embedding<br/>å‚æ•°è®¾ç½®:<br/>â€¢ num_embeddings=4<br/>â€¢ embedding_dim=5"]
                
                C --> D["ğŸ“Š åµŒå…¥æƒé‡çŸ©é˜µ E<br/>å½¢çŠ¶: (4Ã—5)<br/>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br/>â”‚ 0: [0.1, 0.2, 0.3, 0.4, 0.5] â”‚<br/>â”‚ 1: [0.6, 0.7, 0.8, 0.9, 1.0] â”‚<br/>â”‚ 2: [1.1, 1.2, 1.3, 1.4, 1.5] â”‚<br/>â”‚ 3: [1.6, 1.7, 1.8, 1.9, 2.0] â”‚<br/>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"]
                
                D --> E["âš¡ ç›´æ¥ç´¢å¼•æŸ¥æ‰¾<br/>ğŸ” ID=2 â†’ è¡Œ2: [1.1, 1.2, 1.3, 1.4, 1.5]<br/>ğŸ” ID=3 â†’ è¡Œ3: [1.6, 1.7, 1.8, 1.9, 2.0]<br/>ğŸ” ID=1 â†’ è¡Œ1: [0.6, 0.7, 0.8, 0.9, 1.0]<br/>â±ï¸ æ—¶é—´å¤æ‚åº¦: O(1)<br/>ğŸ’¾ å†…å­˜é«˜æ•ˆ: æ— é¢å¤–çŸ©é˜µ"]
                
                %% çº¿æ€§å±‚è·¯å¾„
                B -->|çŸ©é˜µä¹˜æ³•æ–¹å¼| F["ğŸ”„ One-hotç¼–ç è½¬æ¢<br/>ID â†’ ç¨€ç–å‘é‡"]
                
                F --> G["ğŸ“‹ One-hotçŸ©é˜µ H<br/>å½¢çŠ¶: (3Ã—4)<br/>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br/>â”‚ ID=2: [0,0,1,0] â”‚<br/>â”‚ ID=3: [0,0,0,1] â”‚<br/>â”‚ ID=1: [0,1,0,0] â”‚<br/>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br/>ğŸ’¾ å†…å­˜å ç”¨å¤§,ç¨€ç–çŸ©é˜µ"]
                
                G --> H["ğŸ”§ nn.Linear<br/>å‚æ•°è®¾ç½®:<br/>â€¢ in_features=4<br/>â€¢ out_features=5<br/>â€¢ bias=False"]
                
                H --> I["ğŸ“Š çº¿æ€§å±‚æƒé‡çŸ©é˜µ W<br/>å½¢çŠ¶: (5Ã—4)<br/>W = E^T (åµŒå…¥æƒé‡è½¬ç½®)<br/>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br/>â”‚ [0.1, 0.6, 1.1, 1.6] â”‚<br/>â”‚ [0.2, 0.7, 1.2, 1.7] â”‚<br/>â”‚ [0.3, 0.8, 1.3, 1.8] â”‚<br/>â”‚ [0.4, 0.9, 1.4, 1.9] â”‚<br/>â”‚ [0.5, 1.0, 1.5, 2.0] â”‚<br/>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"]
                
                I --> J["ğŸ§® çŸ©é˜µä¹˜æ³•è¿ç®—<br/>è¾“å‡º = H Ã— W^T<br/>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br/>â”‚ [0,0,1,0]   â”‚ Ã— â”‚ [0.1, 0.2, 0.3, 0.4, 0.5] â”‚<br/>â”‚ [0,0,0,1]   â”‚   â”‚ [0.6, 0.7, 0.8, 0.9, 1.0] â”‚<br/>â”‚ [0,1,0,0]   â”‚   â”‚ [1.1, 1.2, 1.3, 1.4, 1.5] â”‚<br/>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ [1.6, 1.7, 1.8, 1.9, 2.0] â”‚<br/>                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br/>â±ï¸ æ—¶é—´å¤æ‚åº¦: O(dÃ—n)<br/>âš ï¸ å¤§é‡é›¶ä¹˜æ³•è¿ç®—"]
                
                %% ç»“æœæ±‡èš
                E --> K["âœ… è¾“å‡ºç»“æœ<br/>å½¢çŠ¶: (3Ã—5)<br/>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br/>â”‚ [1.1, 1.2, 1.3, 1.4, 1.5] â”‚<br/>â”‚ [1.6, 1.7, 1.8, 1.9, 2.0] â”‚<br/>â”‚ [0.6, 0.7, 0.8, 0.9, 1.0] â”‚<br/>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"]
                
                J --> L["âœ… è¾“å‡ºç»“æœ<br/>å½¢çŠ¶: (3Ã—5)<br/>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br/>â”‚ [1.1, 1.2, 1.3, 1.4, 1.5] â”‚<br/>â”‚ [1.6, 1.7, 1.8, 1.9, 2.0] â”‚<br/>â”‚ [0.6, 0.7, 0.8, 0.9, 1.0] â”‚<br/>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"]
                
                K --> M["ğŸ‰ æ•°å­¦ç­‰ä»·æ€§éªŒè¯<br/>ä¸¤ç§æ–¹æ³•ç»“æœå®Œå…¨ç›¸åŒ!<br/>âœ¨ åµŒå…¥å±‚ = çº¿æ€§å±‚ + One-hot<br/>ä½†åµŒå…¥å±‚æ•ˆç‡æ›´é«˜"]
                L --> M
                
                %% è¯¦ç»†è¯´æ˜æ¡†
                N["ğŸ“š åµŒå…¥å±‚ä¼˜åŠ¿:<br/>â€¢ ç›´æ¥ç´¢å¼•,æ— çŸ©é˜µä¹˜æ³•<br/>â€¢ å†…å­˜å ç”¨å°<br/>â€¢ è®¡ç®—é€Ÿåº¦å¿«<br/>â€¢ GPUå‹å¥½<br/>â€¢ ç°ä»£NLPæ ‡å‡†åšæ³•"]
                
                O["âš ï¸ çº¿æ€§å±‚åŠ£åŠ¿:<br/>â€¢ One-hotç¼–ç ç¨€ç–<br/>â€¢ å¤§é‡æ— æ•ˆé›¶ä¹˜æ³•<br/>â€¢ å†…å­˜å ç”¨å¤§<br/>â€¢ è®¡ç®—èµ„æºæµªè´¹<br/>â€¢ ä»…ç”¨äºç†è®ºéªŒè¯"]
                
                E -.-> N
                J -.-> O
                
                %% æ ·å¼å®šä¹‰
                style A fill:#ffebee,stroke:#e91e63,stroke-width:3px
                style C fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
                style D fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
                style E fill:#e8f5e8,stroke:#4caf50,stroke-width:3px
                style F fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
                style G fill:#e1f5fe,stroke:#0288d1,stroke-width:2px
                style H fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
                style I fill:#fce4ec,stroke:#c2185b,stroke-width:2px
                style J fill:#ffebee,stroke:#f44336,stroke-width:2px
                style K fill:#e8f5e8,stroke:#4caf50,stroke-width:3px
                style L fill:#e8f5e8,stroke:#4caf50,stroke-width:3px
                style M fill:#fff3e0,stroke:#ff9800,stroke-width:4px
                style N fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
                style O fill:#ffebee,stroke:#f44336,stroke-width:2px
        </div>
    </div>
    
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2196f3',
                primaryTextColor: '#fff',
                primaryBorderColor: '#1976d2',
                lineColor: '#666',
                secondaryColor: '#4caf50',
                tertiaryColor: '#ff9800',
                background: '#ffffff',
                mainBkg: '#ffffff',
                secondBkg: '#f8f9fa'
            },
            flowchart: {
                htmlLabels: true,
                curve: 'basis',
                padding: 10
            }
        });
    </script>
</body>
</html>